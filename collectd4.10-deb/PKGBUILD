# Maintainer: Chris Fordham <chris.fordham@rightscale.com>

pkgname=collectd4.10-deb
pkgver=4.10.1
pkgrel=1
pkgdesc='Daemon which collects system performance statistics periodically'
arch=('x86_64')
url="http://collectd.org/"
license=('GPL')
makedepends=(binutils tar)
conflicts=(collectd)

_pkg_site=http://http.us.debian.org
_pkg_site_href=debian/pool/main/c/collectd
_dist_rel=squeeze
_dist_rel_rev=2
_pkg_arch=amd64

source=(
  ${_pkg_site}/${_pkg_site_href}/collectd_${pkgver}-${pkgrel}+${_dist_rel}${_dist_rel_rev}_${_pkg_arch}.deb
  ${_pkg_site}/${_pkg_site_href}/collectd-core_${pkgver}-${pkgrel}+${_dist_rel}${_dist_rel_rev}_${_pkg_arch}.deb
)

md5sums=('4913ca949c7921faf6a18da4bdab271d'
         '05bdc3ea8d88a8efd74bee24f22ea161')        # generate with 'makepkg -g'

prepare() {
  cd "$srcdir"
  
  msg "Extracting collectd debian binary package..."
  ar x "$srcdir/collectd_${pkgver}-${pkgrel}+${_dist_rel}${_dist_rel_rev}_${_pkg_arch}.deb"
  
  msg "Extracting data.tar.gz..."
  tar zxf "$srcdir/data.tar.gz"
  rm "$srcdir/data.tar.gz"
  
  msg "Extracting collectd debian binary package..."
  ar x "$srcdir/collectd-core_${pkgver}-${pkgrel}+${_dist_rel}${_dist_rel_rev}_${_pkg_arch}.deb"
  
  msg "Extracting data.tar.gz..."
  tar zxf "$srcdir/data.tar.gz"
  rm "$srcdir/data.tar.gz"
}

package() {
  msg 'Moving /usr into package.'
  mv "$srcdir/usr" "$pkgdir/"

  msg 'Moving /var into package.'
  mv "$srcdir/var" "$pkgdir/"
}

# vim:set ts=2 sw=2 et: